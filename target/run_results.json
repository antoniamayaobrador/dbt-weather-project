{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-11T15:10:38.169561Z", "invocation_id": "0dd3c4ef-c417-4627-90e2-9b436c890818", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-11T15:10:28.367582Z", "completed_at": "2025-05-11T15:10:28.388945Z"}, {"name": "execute", "started_at": "2025-05-11T15:10:28.390523Z", "completed_at": "2025-05-11T15:10:28.688843Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.32474279403686523, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc476e-0001-585e-0000-000136ea933d"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.weather_project.stg_weather_current", "compiled": true, "compiled_code": "\n\nSELECT\n    TO_TIMESTAMP_NTZ(FECHA) AS date_time,\n    CAST(TEMPERATURA_ACTUAL AS NUMBER(4,1)) AS temperature,\n    CAST(HUMEDAD AS NUMBER(4,1)) AS humidity,\n    CAST(VIENTO AS NUMBER(4,1)) AS wind_speed,\n    STATESKY:description::STRING AS sky_condition,\n    _AIRBYTE_EXTRACTED_AT AS extracted_at\nFROM WEATHER.PALMA.PALMA", "relation_name": "WEATHER.dbt_antoniamaya_staging.stg_weather_current", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-11T15:10:28.704431Z", "completed_at": "2025-05-11T15:10:28.712266Z"}, {"name": "execute", "started_at": "2025-05-11T15:10:28.713261Z", "completed_at": "2025-05-11T15:10:28.969408Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.26749324798583984, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc476e-0001-5889-0000-000136eaa295"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.weather_project.stg_weather_forecast_daily", "compiled": true, "compiled_code": "\n\nWITH forecast_data AS (\n    SELECT\n        PROXIMOS_DIAS AS forecast_days,\n        _AIRBYTE_EXTRACTED_AT AS extracted_at\n    FROM WEATHER.PALMA.PALMA\n)\n\nSELECT\n    extracted_at,\n    forecast_date,\n    max_temp,\n    min_temp,\n    max_humidity,\n    min_humidity,\n    -- Interpolate precipitation_probability\n    COALESCE(\n        precipitation_probability,\n        (PREV_PRECIP + NEXT_PRECIP) / 2,\n        0\n    ) AS precipitation_probability,\n    -- Interpolate sky_condition using previous non-null value\n    COALESCE(\n        sky_condition,\n        PREV_SKY\n    ) AS sky_condition,\n    -- Interpolate uv_index\n    COALESCE(\n        uv_index,\n        (PREV_UV + NEXT_UV) / 2,\n        0\n    ) AS uv_index\nFROM (\n    SELECT\n        extracted_at,\n        f.value:\"@attributes\":fecha::STRING AS forecast_date,\n        f.value:temperatura:maxima::NUMBER(4,1) AS max_temp,\n        f.value:temperatura:minima::NUMBER(4,1) AS min_temp,\n        f.value:humedad_relativa:maxima::NUMBER(4,1) AS max_humidity,\n        f.value:humedad_relativa:minima::NUMBER(4,1) AS min_humidity,\n        f.value:prob_precipitacion[0]::NUMBER AS precipitation_probability,\n        f.value:estado_cielo_descripcion[0]::STRING AS sky_condition,\n        f.value:uv_max::NUMBER AS uv_index,\n        -- Previous and next non-null for interpolation\n        LAG(f.value:prob_precipitacion[0]::NUMBER) IGNORE NULLS OVER (ORDER BY f.value:\"@attributes\":fecha::STRING) AS PREV_PRECIP,\n        LEAD(f.value:prob_precipitacion[0]::NUMBER) IGNORE NULLS OVER (ORDER BY f.value:\"@attributes\":fecha::STRING) AS NEXT_PRECIP,\n        LAG(f.value:estado_cielo_descripcion[0]::STRING) IGNORE NULLS OVER (ORDER BY f.value:\"@attributes\":fecha::STRING) AS PREV_SKY,\n        LAG(f.value:uv_max::NUMBER) IGNORE NULLS OVER (ORDER BY f.value:\"@attributes\":fecha::STRING) AS PREV_UV,\n        LEAD(f.value:uv_max::NUMBER) IGNORE NULLS OVER (ORDER BY f.value:\"@attributes\":fecha::STRING) AS NEXT_UV\n    FROM forecast_data,\n    LATERAL FLATTEN(input => forecast_days) f\n)", "relation_name": "WEATHER.dbt_antoniamaya_staging.stg_weather_forecast_daily", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-11T15:10:28.978093Z", "completed_at": "2025-05-11T15:10:28.986742Z"}, {"name": "execute", "started_at": "2025-05-11T15:10:28.987770Z", "completed_at": "2025-05-11T15:10:29.236773Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.26087093353271484, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc476e-0001-585e-0000-000136ea9341"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.weather_project.stg_weather_forecast_hourly", "compiled": true, "compiled_code": "\n\nWITH hourly_data AS (\n    SELECT\n        PRONOSTICO:hoy AS hourly_forecast,\n        _AIRBYTE_EXTRACTED_AT AS extracted_at\n    FROM WEATHER.PALMA.PALMA\n),\n\nforecast_date AS (\n    SELECT\n        extracted_at,\n        hourly_forecast:\"@attributes\":fecha::STRING AS forecast_date\n    FROM hourly_data\n),\n\ntemperatures AS (\n    SELECT\n        h.extracted_at,\n        fd.forecast_date,\n        f.index AS hour_index,\n        f.value::NUMBER(4,1) AS temperature\n    FROM hourly_data h\n    JOIN forecast_date fd ON h.extracted_at = fd.extracted_at\n    , LATERAL FLATTEN(input => h.hourly_forecast:temperatura) f\n),\n\nhumidity AS (\n    SELECT\n        h.extracted_at,\n        fd.forecast_date,\n        f.index AS hour_index,\n        f.value::NUMBER(4,1) AS humidity\n    FROM hourly_data h\n    JOIN forecast_date fd ON h.extracted_at = fd.extracted_at\n    , LATERAL FLATTEN(input => h.hourly_forecast:humedad_relativa) f\n),\n\nsky_conditions AS (\n    SELECT\n        h.extracted_at,\n        fd.forecast_date,\n        f.index AS hour_index,\n        f.value::STRING AS sky_condition\n    FROM hourly_data h\n    JOIN forecast_date fd ON h.extracted_at = fd.extracted_at\n    , LATERAL FLATTEN(input => h.hourly_forecast:estado_cielo_descripcion) f\n),\n\nwind AS (\n    SELECT\n        h.extracted_at,\n        fd.forecast_date,\n        f.value:\"@attributes\":periodo::NUMBER AS hour_index,\n        f.value:direccion::STRING AS wind_direction,\n        f.value:velocidad::NUMBER AS wind_speed\n    FROM hourly_data h\n    JOIN forecast_date fd ON h.extracted_at = fd.extracted_at\n    , LATERAL FLATTEN(input => h.hourly_forecast:viento) f\n)\n\nSELECT\n    t.extracted_at,\n    t.forecast_date,\n    t.hour_index,\n    CASE \n        WHEN t.hour_index = 0 THEN '00:00'\n        WHEN t.hour_index = 6 THEN '06:00'\n        WHEN t.hour_index = 12 THEN '12:00'\n        WHEN t.hour_index = 18 THEN '18:00'\n        ELSE t.hour_index || ':00'\n    END AS time_of_day,\n    COALESCE(t.temperature, 0) AS temperature,\n    COALESCE(h.humidity, 0) AS humidity,\n    COALESCE(s.sky_condition, 'unknown') AS sky_condition,\n    COALESCE(w.wind_direction, 'unknown') AS wind_direction,\n    COALESCE(w.wind_speed, 0) AS wind_speed\nFROM temperatures t\nLEFT JOIN humidity h ON t.extracted_at = h.extracted_at AND t.hour_index = h.hour_index AND t.forecast_date = h.forecast_date\nLEFT JOIN sky_conditions s ON t.extracted_at = s.extracted_at AND t.hour_index = s.hour_index AND t.forecast_date = s.forecast_date\nLEFT JOIN wind w ON t.extracted_at = w.extracted_at AND t.hour_index = w.hour_index AND t.forecast_date = w.forecast_date", "relation_name": "WEATHER.dbt_antoniamaya_staging.stg_weather_forecast_hourly", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-11T15:10:29.245196Z", "completed_at": "2025-05-11T15:10:29.270700Z"}, {"name": "execute", "started_at": "2025-05-11T15:10:29.272943Z", "completed_at": "2025-05-11T15:10:31.019205Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7762768268585205, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc476e-0001-585e-0000-000136ea934d"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.weather_project.weather_current_metrics", "compiled": true, "compiled_code": "\n\nSELECT \n    date_time,\n    temperature,\n    humidity,\n    wind_speed,\n    sky_condition,\n    extracted_at\nFROM WEATHER.dbt_antoniamaya_staging.stg_weather_current\n\n\n  WHERE extracted_at > (SELECT MAX(extracted_at) FROM WEATHER.dbt_antoniamaya_marts.weather_current_metrics)\n", "relation_name": "WEATHER.dbt_antoniamaya_marts.weather_current_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-11T15:10:31.036801Z", "completed_at": "2025-05-11T15:10:31.052433Z"}, {"name": "execute", "started_at": "2025-05-11T15:10:31.053533Z", "completed_at": "2025-05-11T15:10:33.595369Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.561691999435425, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01bc476e-0001-5889-0000-000136eaa2b1"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.weather_project.weather_daily_summary", "compiled": true, "compiled_code": "\n\nSELECT\n    TO_DATE(forecast_date) AS date,\n    MAX(extracted_at) AS last_updated,\n    AVG(max_temp) AS avg_max_temp,\n    AVG(min_temp) AS avg_min_temp,\n    MAX(max_temp) AS highest_temp,\n    MIN(min_temp) AS lowest_temp,\n    AVG(precipitation_probability) AS avg_precipitation_prob,\n    MAX(precipitation_probability) AS max_precipitation_prob,\n    MAX(uv_index) AS max_uv_index,\n    LISTAGG(DISTINCT sky_condition, ', ') AS weather_conditions\nFROM WEATHER.dbt_antoniamaya_staging.stg_weather_forecast_daily\n\n  WHERE TO_DATE(forecast_date) > (SELECT max(date) FROM WEATHER.dbt_antoniamaya_marts.weather_daily_summary)\n\nGROUP BY date\nORDER BY date", "relation_name": "WEATHER.dbt_antoniamaya_marts.weather_daily_summary", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-11T15:10:33.605287Z", "completed_at": "2025-05-11T15:10:33.617558Z"}, {"name": "execute", "started_at": "2025-05-11T15:10:33.618529Z", "completed_at": "2025-05-11T15:10:35.114978Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.511754035949707, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01bc476e-0001-585e-0000-000136ea9369"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.weather_project.weather_daily_snapshot", "compiled": true, "compiled_code": "\n\nWITH latest_current AS (\n    SELECT\n        date_time::date AS date,\n        temperature AS current_temperature,\n        humidity AS current_humidity,\n        wind_speed AS current_wind_speed,\n        sky_condition AS current_sky_condition,\n        extracted_at,\n        ROW_NUMBER() OVER (PARTITION BY date_time::date ORDER BY extracted_at DESC) AS rn\n    FROM WEATHER.dbt_antoniamaya_marts.weather_current_metrics\n)\n\nSELECT\n    d.*, \n    l.current_temperature,\n    l.current_humidity,\n    l.current_wind_speed,\n    l.current_sky_condition,\n    l.extracted_at AS current_extracted_at\nFROM WEATHER.dbt_antoniamaya_marts.weather_daily_summary d\nLEFT JOIN latest_current l ON d.date = l.date AND l.rn = 1\n\n  WHERE d.date > (SELECT max(date) FROM WEATHER.dbt_antoniamaya_marts.weather_daily_snapshot)\n\nORDER BY d.date", "relation_name": "WEATHER.dbt_antoniamaya_marts.weather_daily_snapshot", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-11T15:10:35.126387Z", "completed_at": "2025-05-11T15:10:35.136319Z"}, {"name": "execute", "started_at": "2025-05-11T15:10:35.137285Z", "completed_at": "2025-05-11T15:10:36.488092Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3660387992858887, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01bc476e-0001-585e-0000-000136ea937d"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.weather_project.weather_extremes", "compiled": true, "compiled_code": "\n\nWITH extremes AS (\n    SELECT\n        date,\n        avg_max_temp,\n        avg_min_temp,\n        avg_precipitation_prob,\n        max_uv_index,\n        weather_conditions,\n        ROW_NUMBER() OVER (ORDER BY avg_max_temp DESC) AS hottest_day,\n        ROW_NUMBER() OVER (ORDER BY avg_min_temp ASC) AS coldest_day,\n        ROW_NUMBER() OVER (ORDER BY avg_precipitation_prob DESC) AS wettest_day,\n        ROW_NUMBER() OVER (ORDER BY max_uv_index DESC) AS highest_uv_day\n    FROM WEATHER.dbt_antoniamaya_marts.weather_daily_summary\n)\n\nSELECT * FROM extremes\nWHERE (hottest_day = 1 OR coldest_day = 1 OR wettest_day = 1 OR highest_uv_day = 1)\n\n  AND date > (SELECT max(date) FROM WEATHER.dbt_antoniamaya_marts.weather_extremes)\n\nORDER BY date", "relation_name": "WEATHER.dbt_antoniamaya_marts.weather_extremes", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-11T15:10:36.501365Z", "completed_at": "2025-05-11T15:10:36.511834Z"}, {"name": "execute", "started_at": "2025-05-11T15:10:36.512813Z", "completed_at": "2025-05-11T15:10:38.061741Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.56402587890625, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01bc476e-0001-5889-0000-000136eaa2e5"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.weather_project.weather_trends", "compiled": true, "compiled_code": "\n\nSELECT\n    date,\n    avg_max_temp,\n    avg_min_temp,\n    avg_precipitation_prob,\n    max_uv_index,\n    weather_conditions,\n    LAG(avg_max_temp) OVER (ORDER BY date) AS prev_avg_max_temp,\n    LAG(avg_min_temp) OVER (ORDER BY date) AS prev_avg_min_temp,\n    LAG(avg_precipitation_prob) OVER (ORDER BY date) AS prev_avg_precipitation_prob,\n    LAG(max_uv_index) OVER (ORDER BY date) AS prev_max_uv_index,\n    avg_max_temp - LAG(avg_max_temp) OVER (ORDER BY date) AS delta_max_temp,\n    avg_min_temp - LAG(avg_min_temp) OVER (ORDER BY date) AS delta_min_temp,\n    avg_precipitation_prob - LAG(avg_precipitation_prob) OVER (ORDER BY date) AS delta_precipitation_prob,\n    max_uv_index - LAG(max_uv_index) OVER (ORDER BY date) AS delta_uv_index\nFROM WEATHER.dbt_antoniamaya_marts.weather_daily_summary\n\n  WHERE date > (SELECT max(date) FROM WEATHER.dbt_antoniamaya_marts.weather_trends)\n\nORDER BY date", "relation_name": "WEATHER.dbt_antoniamaya_marts.weather_trends", "batch_results": null}], "elapsed_time": 11.281244993209839, "args": {"which": "run", "quiet": false, "empty": false, "populate_cache": true, "require_resource_names_without_spaces": false, "exclude": [], "log_level": "info", "use_colors_file": true, "version_check": true, "printer_width": 80, "invocation_command": "dbt run", "log_file_max_bytes": 10485760, "log_level_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "partial_parse": true, "introspect": true, "write_json": true, "cache_selected_only": false, "log_format": "default", "print": true, "profiles_dir": "/Users/toniamayaobrador/dbt weather project", "static_parser": true, "log_path": "/Users/toniamayaobrador/dbt weather project/logs", "skip_nodes_if_on_run_start_fails": false, "strict_mode": false, "source_freshness_run_project_hooks": false, "select": [], "state_modified_compare_vars": false, "require_explicit_package_overrides_for_builtin_materializations": true, "favor_state": false, "macro_debugging": false, "log_format_file": "debug", "show_resource_report": false, "require_nested_cumulative_type_params": false, "project_dir": "/Users/toniamayaobrador/dbt weather project", "warn_error_options": {"include": [], "exclude": []}, "defer": false, "require_batched_execution_for_custom_microbatch_strategy": false, "partial_parse_file_diff": true, "state_modified_compare_more_unrendered_values": false, "send_anonymous_usage_stats": true, "vars": {}, "indirect_selection": "eager", "use_colors": true}}