{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-12T12:51:33.581919Z", "invocation_id": "f25621e6-bac8-4f1f-b023-1839b2b6a6a7", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T12:51:27.941926Z", "completed_at": "2025-05-12T12:51:27.953586Z"}, {"name": "execute", "started_at": "2025-05-12T12:51:27.954314Z", "completed_at": "2025-05-12T12:51:28.260887Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.32019901275634766, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc4c83-0001-58c3-0000-000136eab231"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.weather_project.stg_weather_current", "compiled": true, "compiled_code": "\n\nSELECT\n    TO_TIMESTAMP_NTZ(FECHA) AS date_time,\n    CAST(TEMPERATURA_ACTUAL AS NUMBER(4,1)) AS temperature,\n    CAST(HUMEDAD AS NUMBER(4,1)) AS humidity,\n    CAST(VIENTO AS NUMBER(4,1)) AS wind_speed,\n    STATESKY:description::STRING AS sky_condition,\n    _AIRBYTE_EXTRACTED_AT AS extracted_at\nFROM WEATHER.PALMA.PALMA", "relation_name": "WEATHER.PALMAPROD_staging.stg_weather_current", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T12:51:28.268506Z", "completed_at": "2025-05-12T12:51:28.273486Z"}, {"name": "execute", "started_at": "2025-05-12T12:51:28.274085Z", "completed_at": "2025-05-12T12:51:28.558014Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2908909320831299, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc4c83-0001-58c8-0000-000136eac03d"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.weather_project.stg_weather_forecast_daily", "compiled": true, "compiled_code": "\n\nWITH forecast_data AS (\n    SELECT\n        PROXIMOS_DIAS AS forecast_days,\n        _AIRBYTE_EXTRACTED_AT AS extracted_at\n    FROM WEATHER.PALMA.PALMA\n)\n\nSELECT\n    extracted_at,\n    forecast_date,\n    max_temp,\n    min_temp,\n    max_humidity,\n    min_humidity,\n    -- Interpolate precipitation_probability\n    COALESCE(\n        precipitation_probability,\n        (PREV_PRECIP + NEXT_PRECIP) / 2,\n        0\n    ) AS precipitation_probability,\n    -- Interpolate sky_condition using previous non-null value\n    COALESCE(\n        sky_condition,\n        PREV_SKY\n    ) AS sky_condition,\n    -- Interpolate uv_index\n    COALESCE(\n        uv_index,\n        (PREV_UV + NEXT_UV) / 2,\n        0\n    ) AS uv_index\nFROM (\n    SELECT\n        extracted_at,\n        f.value:\"@attributes\":fecha::STRING AS forecast_date,\n        f.value:temperatura:maxima::NUMBER(4,1) AS max_temp,\n        f.value:temperatura:minima::NUMBER(4,1) AS min_temp,\n        f.value:humedad_relativa:maxima::NUMBER(4,1) AS max_humidity,\n        f.value:humedad_relativa:minima::NUMBER(4,1) AS min_humidity,\n        f.value:prob_precipitacion[0]::NUMBER AS precipitation_probability,\n        f.value:estado_cielo_descripcion[0]::STRING AS sky_condition,\n        f.value:uv_max::NUMBER AS uv_index,\n        -- Previous and next non-null for interpolation\n        LAG(f.value:prob_precipitacion[0]::NUMBER) IGNORE NULLS OVER (ORDER BY f.value:\"@attributes\":fecha::STRING) AS PREV_PRECIP,\n        LEAD(f.value:prob_precipitacion[0]::NUMBER) IGNORE NULLS OVER (ORDER BY f.value:\"@attributes\":fecha::STRING) AS NEXT_PRECIP,\n        LAG(f.value:estado_cielo_descripcion[0]::STRING) IGNORE NULLS OVER (ORDER BY f.value:\"@attributes\":fecha::STRING) AS PREV_SKY,\n        LAG(f.value:uv_max::NUMBER) IGNORE NULLS OVER (ORDER BY f.value:\"@attributes\":fecha::STRING) AS PREV_UV,\n        LEAD(f.value:uv_max::NUMBER) IGNORE NULLS OVER (ORDER BY f.value:\"@attributes\":fecha::STRING) AS NEXT_UV\n    FROM forecast_data,\n    LATERAL FLATTEN(input => forecast_days) f\n)", "relation_name": "WEATHER.PALMAPROD_staging.stg_weather_forecast_daily", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T12:51:28.563970Z", "completed_at": "2025-05-12T12:51:28.569478Z"}, {"name": "execute", "started_at": "2025-05-12T12:51:28.570110Z", "completed_at": "2025-05-12T12:51:28.847013Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.28446483612060547, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc4c83-0001-585e-0000-000136ea9885"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.weather_project.stg_weather_forecast_hourly", "compiled": true, "compiled_code": "\n\nWITH hourly_data AS (\n    SELECT\n        PRONOSTICO:hoy AS hourly_forecast,\n        _AIRBYTE_EXTRACTED_AT AS extracted_at\n    FROM WEATHER.PALMA.PALMA\n),\n\nforecast_date AS (\n    SELECT\n        extracted_at,\n        hourly_forecast:\"@attributes\":fecha::STRING AS forecast_date\n    FROM hourly_data\n),\n\ntemperatures AS (\n    SELECT\n        h.extracted_at,\n        fd.forecast_date,\n        f.index AS hour_index,\n        f.value::NUMBER(4,1) AS temperature\n    FROM hourly_data h\n    JOIN forecast_date fd ON h.extracted_at = fd.extracted_at\n    , LATERAL FLATTEN(input => h.hourly_forecast:temperatura) f\n),\n\nhumidity AS (\n    SELECT\n        h.extracted_at,\n        fd.forecast_date,\n        f.index AS hour_index,\n        f.value::NUMBER(4,1) AS humidity\n    FROM hourly_data h\n    JOIN forecast_date fd ON h.extracted_at = fd.extracted_at\n    , LATERAL FLATTEN(input => h.hourly_forecast:humedad_relativa) f\n),\n\nsky_conditions AS (\n    SELECT\n        h.extracted_at,\n        fd.forecast_date,\n        f.index AS hour_index,\n        f.value::STRING AS sky_condition\n    FROM hourly_data h\n    JOIN forecast_date fd ON h.extracted_at = fd.extracted_at\n    , LATERAL FLATTEN(input => h.hourly_forecast:estado_cielo_descripcion) f\n),\n\nwind AS (\n    SELECT\n        h.extracted_at,\n        fd.forecast_date,\n        f.value:\"@attributes\":periodo::NUMBER AS hour_index,\n        f.value:direccion::STRING AS wind_direction,\n        f.value:velocidad::NUMBER AS wind_speed\n    FROM hourly_data h\n    JOIN forecast_date fd ON h.extracted_at = fd.extracted_at\n    , LATERAL FLATTEN(input => h.hourly_forecast:viento) f\n)\n\nSELECT\n    t.extracted_at,\n    t.forecast_date,\n    t.hour_index,\n    CASE \n        WHEN t.hour_index = 0 THEN '00:00'\n        WHEN t.hour_index = 6 THEN '06:00'\n        WHEN t.hour_index = 12 THEN '12:00'\n        WHEN t.hour_index = 18 THEN '18:00'\n        ELSE t.hour_index || ':00'\n    END AS time_of_day,\n    COALESCE(t.temperature, 0) AS temperature,\n    COALESCE(h.humidity, 0) AS humidity,\n    COALESCE(s.sky_condition, 'unknown') AS sky_condition,\n    COALESCE(w.wind_direction, 'unknown') AS wind_direction,\n    COALESCE(w.wind_speed, 0) AS wind_speed\nFROM temperatures t\nLEFT JOIN humidity h ON t.extracted_at = h.extracted_at AND t.hour_index = h.hour_index AND t.forecast_date = h.forecast_date\nLEFT JOIN sky_conditions s ON t.extracted_at = s.extracted_at AND t.hour_index = s.hour_index AND t.forecast_date = s.forecast_date\nLEFT JOIN wind w ON t.extracted_at = w.extracted_at AND t.hour_index = w.hour_index AND t.forecast_date = w.forecast_date", "relation_name": "WEATHER.PALMAPROD_staging.stg_weather_forecast_hourly", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T12:51:28.851438Z", "completed_at": "2025-05-12T12:51:28.856330Z"}, {"name": "execute", "started_at": "2025-05-12T12:51:28.856870Z", "completed_at": "2025-05-12T12:51:30.103527Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2532668113708496, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc4c83-0001-58c3-0000-000136eab235"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.weather_project.weather_current_metrics", "compiled": true, "compiled_code": "\n\nSELECT \n    date_time,\n    temperature,\n    humidity,\n    wind_speed,\n    sky_condition,\n    extracted_at\nFROM WEATHER.PALMAPROD_staging.stg_weather_current\n\n", "relation_name": "WEATHER.PALMAPROD_marts.weather_current_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T12:51:30.109133Z", "completed_at": "2025-05-12T12:51:30.114605Z"}, {"name": "execute", "started_at": "2025-05-12T12:51:30.115129Z", "completed_at": "2025-05-12T12:51:31.193976Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0860810279846191, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc4c83-0001-585e-0000-000136ea9889"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.weather_project.weather_daily_summary", "compiled": true, "compiled_code": "\n\nSELECT\n    TO_DATE(forecast_date) AS date,\n    MAX(extracted_at) AS last_updated,\n    AVG(max_temp) AS avg_max_temp,\n    AVG(min_temp) AS avg_min_temp,\n    MAX(max_temp) AS highest_temp,\n    MIN(min_temp) AS lowest_temp,\n    AVG(precipitation_probability) AS avg_precipitation_prob,\n    MAX(precipitation_probability) AS max_precipitation_prob,\n    MAX(uv_index) AS max_uv_index,\n    LISTAGG(DISTINCT sky_condition, ', ') AS weather_conditions\nFROM WEATHER.PALMAPROD_staging.stg_weather_forecast_daily\n\nGROUP BY date\nORDER BY date", "relation_name": "WEATHER.PALMAPROD_marts.weather_daily_summary", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T12:51:31.199791Z", "completed_at": "2025-05-12T12:51:31.206053Z"}, {"name": "execute", "started_at": "2025-05-12T12:51:31.206664Z", "completed_at": "2025-05-12T12:51:32.192152Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9937007427215576, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc4c83-0001-58c8-0000-000136eac045"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.weather_project.weather_daily_snapshot", "compiled": true, "compiled_code": "\n\nWITH latest_current AS (\n    SELECT\n        date_time::date AS date,\n        temperature AS current_temperature,\n        humidity AS current_humidity,\n        wind_speed AS current_wind_speed,\n        sky_condition AS current_sky_condition,\n        extracted_at,\n        ROW_NUMBER() OVER (PARTITION BY date_time::date ORDER BY extracted_at DESC) AS rn\n    FROM WEATHER.PALMAPROD_marts.weather_current_metrics\n)\n\nSELECT\n    d.*, \n    l.current_temperature,\n    l.current_humidity,\n    l.current_wind_speed,\n    l.current_sky_condition,\n    l.extracted_at AS current_extracted_at\nFROM WEATHER.PALMAPROD_marts.weather_daily_summary d\nLEFT JOIN latest_current l ON d.date = l.date AND l.rn = 1\n\nORDER BY d.date", "relation_name": "WEATHER.PALMAPROD_marts.weather_daily_snapshot", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T12:51:32.197139Z", "completed_at": "2025-05-12T12:51:32.201765Z"}, {"name": "execute", "started_at": "2025-05-12T12:51:32.202274Z", "completed_at": "2025-05-12T12:51:32.803762Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6078147888183594, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc4c83-0001-58c3-0000-000136eab23d"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.weather_project.weather_extremes", "compiled": true, "compiled_code": "\n\nWITH extremes AS (\n    SELECT\n        date,\n        avg_max_temp,\n        avg_min_temp,\n        avg_precipitation_prob,\n        max_uv_index,\n        weather_conditions,\n        ROW_NUMBER() OVER (ORDER BY avg_max_temp DESC) AS hottest_day,\n        ROW_NUMBER() OVER (ORDER BY avg_min_temp ASC) AS coldest_day,\n        ROW_NUMBER() OVER (ORDER BY avg_precipitation_prob DESC) AS wettest_day,\n        ROW_NUMBER() OVER (ORDER BY max_uv_index DESC) AS highest_uv_day\n    FROM WEATHER.PALMAPROD_marts.weather_daily_summary\n)\n\nSELECT * FROM extremes\nWHERE (hottest_day = 1 OR coldest_day = 1 OR wettest_day = 1 OR highest_uv_day = 1)\n\nORDER BY date", "relation_name": "WEATHER.PALMAPROD_marts.weather_extremes", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T12:51:32.808806Z", "completed_at": "2025-05-12T12:51:32.814210Z"}, {"name": "execute", "started_at": "2025-05-12T12:51:32.814732Z", "completed_at": "2025-05-12T12:51:33.486722Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6790540218353271, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc4c83-0001-585e-0000-000136ea9891"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.weather_project.weather_trends", "compiled": true, "compiled_code": "\n\nSELECT\n    date,\n    avg_max_temp,\n    avg_min_temp,\n    avg_precipitation_prob,\n    max_uv_index,\n    weather_conditions,\n    LAG(avg_max_temp) OVER (ORDER BY date) AS prev_avg_max_temp,\n    LAG(avg_min_temp) OVER (ORDER BY date) AS prev_avg_min_temp,\n    LAG(avg_precipitation_prob) OVER (ORDER BY date) AS prev_avg_precipitation_prob,\n    LAG(max_uv_index) OVER (ORDER BY date) AS prev_max_uv_index,\n    avg_max_temp - LAG(avg_max_temp) OVER (ORDER BY date) AS delta_max_temp,\n    avg_min_temp - LAG(avg_min_temp) OVER (ORDER BY date) AS delta_min_temp,\n    avg_precipitation_prob - LAG(avg_precipitation_prob) OVER (ORDER BY date) AS delta_precipitation_prob,\n    max_uv_index - LAG(max_uv_index) OVER (ORDER BY date) AS delta_uv_index\nFROM WEATHER.PALMAPROD_marts.weather_daily_summary\n\nORDER BY date", "relation_name": "WEATHER.PALMAPROD_marts.weather_trends", "batch_results": null}], "elapsed_time": 7.153881072998047, "args": {"require_nested_cumulative_type_params": false, "profiles_dir": "/Users/toniamayaobrador/dbt weather project", "show_resource_report": false, "log_format": "default", "use_colors_file": true, "vars": {}, "require_yaml_configuration_for_mf_time_spines": false, "macro_debugging": false, "which": "run", "warn_error_options": {"include": [], "exclude": []}, "populate_cache": true, "write_json": true, "require_resource_names_without_spaces": false, "log_path": "/Users/toniamayaobrador/dbt weather project/logs", "empty": false, "source_freshness_run_project_hooks": false, "printer_width": 80, "version_check": true, "favor_state": false, "introspect": true, "static_parser": true, "require_batched_execution_for_custom_microbatch_strategy": false, "log_format_file": "debug", "indirect_selection": "eager", "partial_parse_file_diff": true, "send_anonymous_usage_stats": true, "log_level": "info", "invocation_command": "dbt run --target PALMAPROD", "log_level_file": "debug", "select": [], "quiet": false, "state_modified_compare_more_unrendered_values": false, "cache_selected_only": false, "log_file_max_bytes": 10485760, "defer": false, "exclude": [], "partial_parse": true, "print": true, "require_explicit_package_overrides_for_builtin_materializations": true, "state_modified_compare_vars": false, "strict_mode": false, "project_dir": "/Users/toniamayaobrador/dbt weather project", "target": "PALMAPROD", "use_colors": true, "skip_nodes_if_on_run_start_fails": false}}