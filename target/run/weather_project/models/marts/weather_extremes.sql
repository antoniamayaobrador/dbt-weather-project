-- back compat for old kwarg name
  
  begin;
    
        
            
	    
	    
            
        
    

    

    merge into WEATHER.dbt_antoniamaya_marts.weather_extremes as DBT_INTERNAL_DEST
        using WEATHER.dbt_antoniamaya_marts.weather_extremes__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.date = DBT_INTERNAL_DEST.date))

    
    when matched then update set
        "DATE" = DBT_INTERNAL_SOURCE."DATE","AVG_MAX_TEMP" = DBT_INTERNAL_SOURCE."AVG_MAX_TEMP","AVG_MIN_TEMP" = DBT_INTERNAL_SOURCE."AVG_MIN_TEMP","AVG_PRECIPITATION_PROB" = DBT_INTERNAL_SOURCE."AVG_PRECIPITATION_PROB","MAX_UV_INDEX" = DBT_INTERNAL_SOURCE."MAX_UV_INDEX","WEATHER_CONDITIONS" = DBT_INTERNAL_SOURCE."WEATHER_CONDITIONS","HOTTEST_DAY" = DBT_INTERNAL_SOURCE."HOTTEST_DAY","COLDEST_DAY" = DBT_INTERNAL_SOURCE."COLDEST_DAY","WETTEST_DAY" = DBT_INTERNAL_SOURCE."WETTEST_DAY","HIGHEST_UV_DAY" = DBT_INTERNAL_SOURCE."HIGHEST_UV_DAY"
    

    when not matched then insert
        ("DATE", "AVG_MAX_TEMP", "AVG_MIN_TEMP", "AVG_PRECIPITATION_PROB", "MAX_UV_INDEX", "WEATHER_CONDITIONS", "HOTTEST_DAY", "COLDEST_DAY", "WETTEST_DAY", "HIGHEST_UV_DAY")
    values
        ("DATE", "AVG_MAX_TEMP", "AVG_MIN_TEMP", "AVG_PRECIPITATION_PROB", "MAX_UV_INDEX", "WEATHER_CONDITIONS", "HOTTEST_DAY", "COLDEST_DAY", "WETTEST_DAY", "HIGHEST_UV_DAY")

;
    commit;