-- back compat for old kwarg name
  
  begin;
    
        
            
	    
	    
            
        
    

    

    merge into WEATHER.dbt_antoniamaya_marts.weather_daily_summary as DBT_INTERNAL_DEST
        using WEATHER.dbt_antoniamaya_marts.weather_daily_summary__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.date = DBT_INTERNAL_DEST.date))

    
    when matched then update set
        "DATE" = DBT_INTERNAL_SOURCE."DATE","LAST_UPDATED" = DBT_INTERNAL_SOURCE."LAST_UPDATED","AVG_MAX_TEMP" = DBT_INTERNAL_SOURCE."AVG_MAX_TEMP","AVG_MIN_TEMP" = DBT_INTERNAL_SOURCE."AVG_MIN_TEMP","HIGHEST_TEMP" = DBT_INTERNAL_SOURCE."HIGHEST_TEMP","LOWEST_TEMP" = DBT_INTERNAL_SOURCE."LOWEST_TEMP","AVG_PRECIPITATION_PROB" = DBT_INTERNAL_SOURCE."AVG_PRECIPITATION_PROB","MAX_PRECIPITATION_PROB" = DBT_INTERNAL_SOURCE."MAX_PRECIPITATION_PROB","MAX_UV_INDEX" = DBT_INTERNAL_SOURCE."MAX_UV_INDEX","WEATHER_CONDITIONS" = DBT_INTERNAL_SOURCE."WEATHER_CONDITIONS"
    

    when not matched then insert
        ("DATE", "LAST_UPDATED", "AVG_MAX_TEMP", "AVG_MIN_TEMP", "HIGHEST_TEMP", "LOWEST_TEMP", "AVG_PRECIPITATION_PROB", "MAX_PRECIPITATION_PROB", "MAX_UV_INDEX", "WEATHER_CONDITIONS")
    values
        ("DATE", "LAST_UPDATED", "AVG_MAX_TEMP", "AVG_MIN_TEMP", "HIGHEST_TEMP", "LOWEST_TEMP", "AVG_PRECIPITATION_PROB", "MAX_PRECIPITATION_PROB", "MAX_UV_INDEX", "WEATHER_CONDITIONS")

;
    commit;