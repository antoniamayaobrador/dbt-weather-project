-- back compat for old kwarg name
  
  begin;
    
        
            
	    
	    
            
        
    

    

    merge into WEATHER.dbt_antoniamaya_marts.weather_trends as DBT_INTERNAL_DEST
        using WEATHER.dbt_antoniamaya_marts.weather_trends__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.date = DBT_INTERNAL_DEST.date))

    
    when matched then update set
        "DATE" = DBT_INTERNAL_SOURCE."DATE","AVG_MAX_TEMP" = DBT_INTERNAL_SOURCE."AVG_MAX_TEMP","AVG_MIN_TEMP" = DBT_INTERNAL_SOURCE."AVG_MIN_TEMP","AVG_PRECIPITATION_PROB" = DBT_INTERNAL_SOURCE."AVG_PRECIPITATION_PROB","MAX_UV_INDEX" = DBT_INTERNAL_SOURCE."MAX_UV_INDEX","WEATHER_CONDITIONS" = DBT_INTERNAL_SOURCE."WEATHER_CONDITIONS","PREV_AVG_MAX_TEMP" = DBT_INTERNAL_SOURCE."PREV_AVG_MAX_TEMP","PREV_AVG_MIN_TEMP" = DBT_INTERNAL_SOURCE."PREV_AVG_MIN_TEMP","PREV_AVG_PRECIPITATION_PROB" = DBT_INTERNAL_SOURCE."PREV_AVG_PRECIPITATION_PROB","PREV_MAX_UV_INDEX" = DBT_INTERNAL_SOURCE."PREV_MAX_UV_INDEX","DELTA_MAX_TEMP" = DBT_INTERNAL_SOURCE."DELTA_MAX_TEMP","DELTA_MIN_TEMP" = DBT_INTERNAL_SOURCE."DELTA_MIN_TEMP","DELTA_PRECIPITATION_PROB" = DBT_INTERNAL_SOURCE."DELTA_PRECIPITATION_PROB","DELTA_UV_INDEX" = DBT_INTERNAL_SOURCE."DELTA_UV_INDEX"
    

    when not matched then insert
        ("DATE", "AVG_MAX_TEMP", "AVG_MIN_TEMP", "AVG_PRECIPITATION_PROB", "MAX_UV_INDEX", "WEATHER_CONDITIONS", "PREV_AVG_MAX_TEMP", "PREV_AVG_MIN_TEMP", "PREV_AVG_PRECIPITATION_PROB", "PREV_MAX_UV_INDEX", "DELTA_MAX_TEMP", "DELTA_MIN_TEMP", "DELTA_PRECIPITATION_PROB", "DELTA_UV_INDEX")
    values
        ("DATE", "AVG_MAX_TEMP", "AVG_MIN_TEMP", "AVG_PRECIPITATION_PROB", "MAX_UV_INDEX", "WEATHER_CONDITIONS", "PREV_AVG_MAX_TEMP", "PREV_AVG_MIN_TEMP", "PREV_AVG_PRECIPITATION_PROB", "PREV_MAX_UV_INDEX", "DELTA_MAX_TEMP", "DELTA_MIN_TEMP", "DELTA_PRECIPITATION_PROB", "DELTA_UV_INDEX")

;
    commit;